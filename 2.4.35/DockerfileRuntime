# 1. First reference the gearbox-base image.
FROM gearboxworks/gearbox-base:alpine-3.5

# 2. Now copy the local files specific to this image.
COPY build /build
COPY container.json /build/container.json

# 3. Set up env variables.
MAINTAINER Gearbox Team <team@gearbox.works>
ENV GEARBOX_CONTAINER_NAME "docker-apache"
ENV GEARBOX_CONTAINER_VERSION "2.4.35"

# 4. Run the build-base.sh script to set everything up.
RUN /bin/sh /build/build-base.sh

# 5. Run the build-apache.sh script to set everything up.
RUN /bin/sh /build/build-apache.sh

# 6. Expose ports.
EXPOSE 80 443 9970

# 7. Set default command to exec.
CMD ["/usr/sbin/httpd", "-DFOREGROUND"]
